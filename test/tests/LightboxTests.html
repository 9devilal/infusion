<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" 
	"http://www.w3.org/TR/html4/strict.dtd">
<!--
 Fluid Project

 Copyright (c) 2006, 2007 University of Toronto. All rights reserved.

 Licensed under the Educational Community License, Version 1.0 (the "License"); 
 you may not use this file except in compliance with the License. 
 You may obtain a copy of the License at 
 
 http://www.opensource.org/licenses/ecl1.php 
 
 Unless required by applicable law or agreed to in writing, software 
 distributed under the License is distributed on an "AS IS" BASIS, 
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. 
 See the License for the specific language governing permissions and 
 limitations under the License.

 Adaptive Technology Resource Centre, University of Toronto
 130 St. George St., Toronto, Ontario, Canada
 Telephone: (416) 978-4360
-->

<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>Lightbox Tests</title>
	<script language="JavaScript" type="text/javascript" src="../jsunit/app/jsUnitCore.js"> </script>
		<script type="text/javascript" 
			djConfig="isDebug: true"
			src="/dojo/dojo.js"></script>
		<script type="text/javascript">
			dojo.require("fluid.Lightbox");
			dojo.require("dojo._base.event");
			dojo.require("dijit.util.parser");	// scan page for widgets and instantiate them
		</script>

	<style type="text/css">
		@import "/fluid/templates/Lightbox.css";
	</style>

<script>
	
function testHandleArrowKeyPress()	 {
	var lightbox;
	var defaultClass="image-container-default";
	var focusClass="image-container-selected";
	var draggingClass="image-container-dragging";

	lightbox = new fluid.Lightbox();
	lightbox.focus(dojo.byId("fluid.thumb0"));
	
	assertTrue("fluid.thumb0 should be selected",dojo.hasClass(dojo.byId("fluid.thumb0"), focusedClass));
	assertTrue("fluid.thumb1 should be not selected",dojo.hasClass(dojo.byId("fluid.thumb1"), defaultClass));
	var evt = {keyCode: dojo.keys.RIGHT_ARROW };
	lightbox.handleArrowKeyPress(evt);
	assertTrue("fluid.thumb0 should be not selected",dojo.hasClass(dojo.byId("fluid.thumb0"), defaultClass));
	assertTrue("fluid.thumb1 should be selected",dojo.hasClass(dojo.byId("fluid.thumb1"), focusedClass));
	
}

function testFocus () {
	var lightbox;
	var defaultClass="image-container-default";
	var focusClass="image-container-selected";
	var draggingClass="image-container-dragging";

	lightbox = new fluid.Lightbox();
	var urlList = ["http://foo.com/url1", "http://foo.com/url2", "http://foo.com/url3"];
	var imgList;
	imgList = lightbox.buildImageList(urlList);
	lightbox.setDomNode(imgList);

	// check that "some image" isn't focused
alert(dojo.byId("fluid.thumb1"));
/*	assertTrue("fluid.thumb1 should be moveable",dojo.hasClass(dojo.byId("fluid.thumb1"), defaultClass));
	assertFalse("fluid.thumb1 should not be focused",dojo.hasClass(dojo.byId("fluid.thumb1"), focusClass));
	
	// focus the image
	lightbox.focus(dojo.byId("fluid.thumb1"));

	// test the response to the focus
	assertFalse("fluid.thumb1 should not be moveable", dojo.hasClass(dojo.byId("fluid.thumb1"), defaultClass));
	assertTrue("fluid.thumb1 should be focused", dojo.hasClass(dojo.byId("fluid.thumb1"), focusClass));
	
	// focus the image already focused to ensure it remains focused.
	lightbox.focus(dojo.byId("fluid.thumb1"));
	assertTrue("fluid.thumb1 should still be focused",dojo.hasClass(dojo.byId("fluid.thumb1"), focusClass));

	// focus a different image and check to see that the previous image is defocused
	// and the new image is focused
	assertTrue("fluid.thumb2 should be movable",dojo.hasClass(dojo.byId("fluid.thumb2"), defaultClass));
	assertFalse("fluid.thumb2 should not be focused",dojo.hasClass(dojo.byId("fluid.thumb2"), focusClass));
	
	lightbox.focus(dojo.byId ("fluid.thumb2"));
	
	// previous image defocused
	assertTrue("fluid.thumb1 should now be moveable (previously focused)",dojo.hasClass(dojo.byId("fluid.thumb1"), defaultClass));
	assertFalse("fluid.thumb1 should not be focused anymore",dojo.hasClass(dojo.byId("fluid.thumb1"), focusClass));
	
	// new image focused
	assertFalse("fluid.thumb2 should not be moveable",dojo.hasClass(dojo.byId("fluid.thumb2"), defaultClass));
	assertTrue("fluid.thumb2 should be focused",dojo.hasClass(dojo.byId("fluid.thumb2"), focusClass));
	
	// clean up
	dojo.removeClass(dojo.byId("fluid.thumb2"),focusClass);
	dojo.addClass(dojo.byId("fluid.thumb2"),defaultClass);
*/
}

function testBuildImageList() {
	var lightbox;
	lightbox = new fluid.Lightbox();

	assertEquals (0, lightbox.imageList.length);	
	
	var urlList = ["http://foo.com/url1", "http://foo.com/url2", "http://foo.com/url3"];
	var imgList;
	imgList = lightbox.buildImageList(urlList);
	assertEquals (3, imgList.length);

	assertEquals ("http://foo.com/url1", imgList[0].getElementsByTagName("a")[0].href);
	assertEquals ("http://foo.com/url1", imgList[0].getElementsByTagName("img")[0].src);

	assertEquals ("http://foo.com/url2", imgList[1].getElementsByTagName("a")[0].href);
	assertEquals ("http://foo.com/url2", imgList[1].getElementsByTagName("img")[0].src);

	assertEquals ("http://foo.com/url3", imgList[2].getElementsByTagName("a")[0].href);
	assertEquals ("http://foo.com/url3", imgList[2].getElementsByTagName("img")[0].src);
}

</script>
</head>

  <body>
	<p>this is the Lightbox test page</p>

	<input id="fluid.thumb0" dojoType="fluid.Lightbox"/>

  </body>
</html>
